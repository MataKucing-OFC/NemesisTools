#CVE-2023-4666
#The Form Maker by 10Web WordPress plugin before 1.15.20 does not validate signatures when creating them on the server from user input,
#allowing unauthenticated users to create arbitrary files and lead to RCE

from bs4 import BeautifulSoup
import re
import requests
import sys

requests.adapters.DEFAULT_RETRIES = 2
n = len(sys.argv)

x = '''

░█████╗░██╗░░░██╗███████╗░░░░░░██████╗░░█████╗░██████╗░██████╗░░░░░░░░░██╗██╗░█████╗░░█████╗░░█████╗░
██╔══██╗██║░░░██║██╔════╝░░░░░░╚════██╗██╔══██╗╚════██╗╚════██╗░░░░░░░██╔╝██║██╔═══╝░██╔═══╝░██╔═══╝░
██║░░╚═╝╚██╗░██╔╝█████╗░░█████╗░░███╔═╝██║░░██║░░███╔═╝░█████╔╝█████╗██╔╝░██║██████╗░██████╗░██████╗░
██║░░██╗░╚████╔╝░██╔══╝░░╚════╝██╔══╝░░██║░░██║██╔══╝░░░╚═══██╗╚════╝███████║██╔══██╗██╔══██╗██╔══██╗
╚█████╔╝░░╚██╔╝░░███████╗░░░░░░███████╗╚█████╔╝███████╗██████╔╝░░░░░░╚════██║╚█████╔╝╚█████╔╝╚█████╔╝
░╚════╝░░░░╚═╝░░░╚══════╝░░░░░░╚══════╝░╚════╝░╚══════╝╚═════╝░░░░░░░░░░░░╚═╝░╚════╝░░╚════╝░░╚════╝░
'''

print(x)

target = sys.argv[1]
target = target+"/wp-content/plugins/form-maker/readme.txt"

try:
    response = requests.get(f"{target}")
    if response.status_code == 200:
        soup = BeautifulSoup(response.text,'html.parser')
        s = str(soup)
        version = re.search(r'= (\d+).(\d+).(\d+) =',s)
        if version:
            v = version.group()
            x1 = v.split(" ")
            x2 = x1[1].split('.')
            x3 = int(x2[0])
            x4 = int(x2[1])
            x5 = int(x2[2])
            if x3 <= 1 and x4 <=15 and x5 <= 19:
                print('Found Following Version: '+str(x3)+'.'+str(x4)+'.'+str(x5)+' Which appears to be vulnerable to CVE-2023-4666')
            else:
                print('Found Following Version: '+str(x3)+'.'+str(x4)+'.'+str(x5)+' Which does not appears to be vulnerable to CVE-2023-4666')
        else:
            print("Script Does not able to find Version, Check Manually")
    else:
        print("Server Not Available",response.status_code)
except Exception as e:
    print("Please Check URL",e)