#CVE-2023-5360

from bs4 import BeautifulSoup
import re
import requests
import sys

requests.adapters.DEFAULT_RETRIES = 2
n = len(sys.argv)

x = '''
 ██████╗██╗   ██╗███████╗    ██████╗  ██████╗ ██████╗ ██████╗       ███████╗██████╗  ██████╗  ██████╗ 
██╔════╝██║   ██║██╔════╝    ╚════██╗██╔═████╗╚════██╗╚════██╗      ██╔════╝╚════██╗██╔════╝ ██╔═████╗
██║     ██║   ██║█████╗█████╗ █████╔╝██║██╔██║ █████╔╝ █████╔╝█████╗███████╗ █████╔╝███████╗ ██║██╔██║
██║     ╚██╗ ██╔╝██╔══╝╚════╝██╔═══╝ ████╔╝██║██╔═══╝  ╚═══██╗╚════╝╚════██║ ╚═══██╗██╔═══██╗████╔╝██║
╚██████╗ ╚████╔╝ ███████╗    ███████╗╚██████╔╝███████╗██████╔╝      ███████║██████╔╝╚██████╔╝╚██████╔╝
 ╚═════╝  ╚═══╝  ╚══════╝    ╚══════╝ ╚═════╝ ╚══════╝╚═════╝       ╚══════╝╚═════╝  ╚═════╝  ╚═════╝ 
                                                                                                       
Nemesis
Critical Unauthenticated Arbitrary File Upload Vulnerability in Royal Elementor Addons and Templates
'''

print(x)
target = sys.argv[1]
target = target+"/wp-content/plugins/royal-elementor-addons/readme.txt"

try:
    response = requests.get(f"{target}")
    if response.status_code == 200:
        soup = BeautifulSoup(response.text,'html.parser')
        s = str(soup)
        version = re.search(r'Royal Elementor Addons v(\d+).(\d+).(\d+)',s)
        if version:
            v = version.group()
            x1 = v.find('v')
            x2 = v[x1+1:].strip()
            x3 = x2.split('.')
            x4 = int(x3[0])
            x5 = int(x3[1])
            x6 = int(x3[2])
            if x4 <= 1 and x5 <=3 and x6 <= 78:
                print('Found Following Version: '+str(x4)+'.'+str(x5)+'.'+str(x6)+' Which appears to be vulnerable to CVE-2023-5360')
            else:
                print('Found Following Version: '+str(x4)+'.'+str(x5)+'.'+str(x6)+' Which does not appears to be vulnerable to CVE-2023-5360')
        else:
            print("Script Does not able to find Version, Check Manually")
    else:
        print("Server Not Available",response.status_code)
except Exception as e:
    print("Please Check URL",e)